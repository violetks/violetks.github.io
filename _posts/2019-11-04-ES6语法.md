---
layout:     post
title:      ES6语法
date:       2019-11-04
author:     violetks
header-img: img/post-ES6.jpg
catalog: true
tags:
    - ES6
---

> 关于ES6在[ECMAScript6 入门](http://es6.ruanyifeng.com/)中已经有很详细的教程了，这里主要再举些例子

`**ES6**`，全称`**ECMAScript 6.0**`，是JavaScript的第六个版本标准

`**ES6**`用`let` 和`const`声明变量和常量，`**ES5**`用`var`声明

### 一、let和const

#### 1.`let`作用域只局限于当前代码块，是块级作用域，`var`的作用域是函数级的

#### 2.使用`let`声明变量作用域不会被提升

```
{
  var str;
  console.log(str);
  str = "张三";      //var这样是可行的
}
```

#### 3.在相同作用域下`let`不能重复声明同一个变量

#### 4.`for循环`体现`let`的父子作用域
例子：点击按钮
```
<body>

<button>按钮1</button>
<button>按钮2</button>
<button>按钮3</button>

<script>
    var btns = document.querySelectorAll("button");
    for (var i=0;i<btns.length;i++) {
        btns[i].onclick = function () {
            alert("点击了第"+ i +"个按钮");
        }
    }
    //上面这样点击每个按钮都是i=3
    //改为闭包的方式可以解决
    var btns = document.querySelectorAll("button");
    for (var i=0;i<btns.length;i++) {
        (function (i) {
            btns[i].onclick = function () {
                alert("点击了第"+ i +"个按钮");
            }
        })(i);
    }
    //ES6用let，使代码更简洁
    let btns = document.querySelectorAll("button");
    for (let i=0;i<btns.length;i++) {
        btns[i].onclick = function () {
            alert("点击了第"+ i +"个按钮");
        }
    }
</script>
</body>
```

### 二、箭头函数

**1.基本格式：**(参数)=>{ }

```
// 使用箭头函数对数组排序
'use strict'
var arr = [10, 20, 1, 2];
arr.sort((x, y) => {
    return x-y;
});
console.log(arr); // [1, 2, 10, 20]
```

**2.简写：**

（1）有且仅有一个参数，()可以不写

（2）如果有且仅有一个语句并且是`return`，{}可以不写

**3.作用：**
修复this指向
```
let json={
  a: 12,
  fn: function (){
    alert(this.a);
  }
}

jsonk.fn();   //12
```

```
let json={
  a: 12,
  fn: function (){
    alert(this.a);
  }
}

let x = new Date();
x.fn = json.fn;

x.fn();   //undefined
```
用箭头函数改写：
```
let json={
  a: 12,
  fn: ()=>{
    alert(this.a);    //this指向当前环境，此处是window
  }
}

json.fn();   //结果是undefined，因为window对象中没有a
```
使用构造函数：
```
class Json{
  constructor(){
    this.a = 12;
    this.fn = ()=>{
      alert(this.a);
    }
  }
}

let json = new Json();
json.fn();   //12，因为当前环境是Json对象，this指向Json对象

let x = new Date();
x.fn = json.fn;
x.fn();     //12
```

### 三、函数的参数扩展（...）

- 参数展开

```
function show(a, b, ...c){
  console.log(a,b,c);      //a=1,b=3,c=[4,2,6,8]
}

show(1,3,4,2,6,8);
```
```
let arr = [1,5,8];
function show(a,b,c){
  alert(a+b+c);
}

show(...arr);   // 14
```

- 数组展开
合并数组

```
let arr1 = [1,5,8];
let arr2 = [4,5,6];
let arr = [...arr1, ...arr2];
alert(arr);   // [1,5,8,4,5,6]
```

- JSON展开

```
let json = {a: 1, b: 5, c: 8};
let json2 = {
  ...json,
  d: 7
};
```

### 四、原生对象扩展
#### 1.Array扩展：map、reduce、filter、forEach

- map 映射：一一对应

```
let arr = [68,53,12,98,65];

let arr2 = arr.map(function (item){
  if(item>=60){
    return '及格';
  }else{
    return '不及格';
  }
});

console.log(arr);
console.log(arr2);
```

使用箭头函数：

```
let arr = [68,53,12,98,65];
let arr2 = arr.map(item=>item>=60?'及格':'不及格');
```

- reduce n=>1

```
let arr = [68,53,12,98,65];
let result = arr.reduce(function (tmp, item, index){
  //alert(index+':'+tmp+','+item);
  return tmp+item;   //总和
});

alert(result);
```
```
// 求平均值
let arr = [68,53,12,98,65];
let result = arr.reduce(function (tmp, item, index){
  if(index==arr.length-1){
    return (tmp+item)/arr.length;   //平均值
  }else{
    return tmp+item;   //总和
  }
});

alert(result);
```

- filter 过滤

```
// 获取一个数组中的偶数
let arr = [68,53,12,98,65,83,16];
let arr2 = arr.filter(item=>item%2==0);
```

- forEach 遍历

```
let arr = [68,53,12,98,65,83,16];
arr.forEach((item,index)=>{
  //alert('第'+index+'个:'+item);
  //使用模板字符串
  alert(`第${index}个：${item}`);
});
```

#### 2.模板字符串
#### 3.JSON
